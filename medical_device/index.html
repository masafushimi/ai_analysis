<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂåªÁôÇÊ©üÂô®„É°„Éº„Ç´„ÉºÂêë„ÅëAIÊ¥ªÁî®„Çπ„É©„Ç§„Éâ (Pro Design)</title>
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* MedTechÂêë„ÅëÔºö‰ø°È†º„Å®ÂÖàÈÄ≤ÊÄß„ÇíË°®„Åô„Éá„Ç£„Éº„Éó„Éç„Ç§„Éì„Éº√ó„É°„Éá„Ç£„Ç´„É´„Éñ„É´„Éº√ó„Ç¥„Éº„É´„Éâ */
            --primary-color: #0d47a1; /* „É°„Éá„Ç£„Ç´„É´„Éç„Ç§„Éì„Éº */
            --accent-color: #ffd700;  /* „Ç¥„Éº„É´„ÉâÔºàÂìÅË≥™„ÉªÊ®©Â®ÅÔºâ */
            --text-color: #263238;
            --light-text: #546e7a;
            --bg-color: #eceff1;
            --slide-bg: #ffffff;
            
            /* Step Colors */
            --step1-bg: #e3f2fd; --step1-border: #1976d2; /* Input: „Éá„Éº„Çø/Ë¶èÂà∂ (Blue) */
            --step2-bg: #f3e5f5; --step2-border: #8e24aa; /* Process: AIËß£Êûê (Purple) */
            --step3-bg: #e8f5e9; --step3-border: #43a047; /* Output: ÊñáÊõ∏/Ëß£Ê±∫ (Green) */
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 40px 20px;
            color: var(--text-color);
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            text-align: center;
        }

        h1.page-title {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
        }

        .controls {
            margin-bottom: 40px;
            padding: 25px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            display: inline-block;
        }

        button.download-btn {
            background: linear-gradient(135deg, var(--primary-color), #002171);
            color: white;
            border: none;
            padding: 16px 36px;
            font-size: 18px;
            font-weight: 700;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            font-family: 'Montserrat', sans-serif;
            box-shadow: 0 4px 10px rgba(13, 71, 161, 0.3);
        }

        button.download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(13, 71, 161, 0.4);
        }

        /* Slide Preview Styles */
        .slide-preview-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            align-items: center;
        }

        .slide {
            width: 960px; /* 16:9 */
            height: 540px;
            background: var(--slide-bg);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            padding: 50px;
            box-sizing: border-box;
            text-align: left;
            overflow: hidden;
            border-radius: 4px;
        }

        .slide::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, var(--primary-color) 60%, var(--accent-color) 100%);
        }

        .slide-number {
            position: absolute;
            bottom: 15px;
            right: 25px;
            color: var(--light-text);
            font-size: 14px;
            font-family: 'Montserrat', sans-serif;
        }

        .slide-title {
            font-size: 30px;
            color: var(--primary-color);
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 12px;
            line-height: 1.3;
        }
        
        .slide-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background-color: var(--accent-color);
        }

        .slide-sub-title {
            font-size: 16px;
            color: var(--light-text);
            font-weight: 500;
            margin-top: -10px;
            margin-bottom: 20px;
        }

        .process-flow {
            display: flex;
            justify-content: space-between;
            align-items: stretch;
            height: 310px;
            margin-top: 10px;
            gap: 15px;
        }

        .step-box {
            flex: 1;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            font-size: 13px;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            background-color: white;
        }

        .step-box h3 {
            margin-top: 5px;
            font-size: 15px;
            color: var(--primary-color);
            margin-bottom: 8px;
            font-weight: 700;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            padding-bottom: 5px;
        }

        .step-1 { background-color: var(--step1-bg); border-top: 4px solid var(--step1-border); }
        .step-2 { background-color: var(--step2-bg); border-top: 4px solid var(--step2-border); }
        .step-3 { background-color: var(--step3-bg); border-top: 4px solid var(--step3-border); }

        .arrow-container {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 20px;
        }
        
        .arrow {
            font-size: 20px;
            color: var(--accent-color);
        }

        .step-content {
            flex-grow: 1;
            line-height: 1.5;
            white-space: pre-wrap;
        }

        .step-label {
            font-size: 10px;
            text-transform: uppercase;
            color: #888;
            margin-bottom: 4px;
            font-weight: 600;
            font-family: 'Montserrat', sans-serif;
            letter-spacing: 0.05em;
        }

        /* Title Slide */
        .title-slide-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 100%;
            padding-left: 20px;
        }
        .slide.title-type::before { background: none; }
        .main-title { 
            font-size: 40px; 
            color: var(--primary-color); 
            margin-bottom: 25px; 
            font-weight: 800; 
            font-family: 'Montserrat', sans-serif;
            line-height: 1.2;
        }
        .sub-title { 
            font-size: 20px; 
            color: var(--text-color); 
            line-height: 1.6;
            border-left: 5px solid var(--accent-color);
            padding-left: 25px;
        }
        
        /* Bullet List */
        .bullet-list { padding-left: 30px; margin-top: 20px; }
        .bullet-list li { 
            margin-bottom: 15px; 
            font-size: 18px; 
            line-height: 1.6;
            color: var(--text-color);
        }
        .bullet-list li strong { color: var(--primary-color); }
        .bullet-list li::marker { color: var(--accent-color); }

    </style>
</head>
<body>

<div class="container">
    <h1 class="page-title">ÂåªÁôÇÊ©üÂô®„É°„Éº„Ç´„ÉºAIÊ¥ªÁî®„Çπ„É©„Ç§„ÉâÁîüÊàê</h1>
    <div class="controls">
        <p>‰ª•‰∏ã„ÅÆ„Éú„Çø„É≥„Åß„ÄÅPowerPoint (.pptx) „Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åß„Åç„Åæ„Åô„ÄÇ</p>
        <button class="download-btn" onclick="generatePPTX()">
            üì• PowerPoint (.pptx) „Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
        </button>
    </div>
            <div class="controls">
        <p>‰ª•‰∏ã„ÅÆ„Éú„Çø„É≥„Åß„ÄÅ„Çµ„Éû„É™„ÉºDocs„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åß„Åç„Åæ„Åô„ÄÇ</p>
<a href="https://docs.google.com/document/d/168ycwZWeut4_xPLQ6uIE_om1iQ11S684E5gFuRDEl1g/edit?usp=sharing">
    ÂåªÁôÇÊ©üÂô®„É°„Éº„Ç´„Éº„Å´„Åä„Åë„ÇãÁîüÊàêAIÊ¥ªÁî®„Å®ÂäπÁéáÊîπÂñÑÂ∫¶Âêà
</a>
    </div>
    <div class="slide-preview-container" id="previewArea"></div>
</div>

<script>
    // --- „Çπ„É©„Ç§„Éâ„Éá„Éº„ÇøÂÆöÁæ© ---
    const slidesData = [
        {
            type: "title",
            title: "ÂåªÁôÇÊ©üÂô®„É°„Éº„Ç´„Éº„Å´„Åä„Åë„Çã\nÁîüÊàêAIÊ¥ªÁî®„Å®Ê•≠Âãô„Éó„É≠„Çª„ÇπÂ§âÈù©",
            sub: "Ë¶èÂà∂„ÅÆ„ÄåÈáç„Åï„Äç„ÇíAI„ÅßÊîªÁï•„Åó„ÄÅ\nÈñãÁô∫„ÉªÂñ∂Ê•≠„Éª„Çµ„Éº„Éì„Çπ„ÅÆË≥™„ÇíÊúÄÂ§ßÂåñ„Åô„Çã"
        },
        {
            type: "concept",
            title: "AIÂ∞éÂÖ•„ÅÆÈçµÔºöÈü≥Â£∞„Éá„Éº„Çø„ÅÆË≥áÁî£Âåñ",
            content: [
                "**1. Ë®òÈå≤„ÅÆËá™ÂãïÂåñ (Voice First):** Áóá‰æãÁ´ã„Å°Âêà„ÅÑ„ÄÅ„Çµ„Éº„Éì„ÇπÂ†±Âëä„ÄÅ‰ºöË≠∞„ÅØ„ÄåÊõ∏„Åè„Äç„Åã„Çâ„ÄåË©±„Åó„Å¶AI„ÅåÊõ∏„Åè„Äç„Å∏„ÄÇ",
                "**2. Ë¶èÂà∂ÂØæÂøú„ÅÆÈ´òÈÄüÂåñ (Regulatory Agility):** ËÜ®Â§ß„Å™PMDA/FDAË¶èÂà∂ÊñáÊõ∏„Å®Á§æÂÜÖÊñáÊõ∏„ÇíNotebookLM„ÅßÁ¥ê„Å•„Åë„ÄÇ",
                "**3. Â§âÊõ¥ÁÆ°ÁêÜ„ÅÆÊîØÊè¥ (Change Control):** 4MÂ§âÊõ¥ÊôÇ„ÅÆÂΩ±ÈüøÂ∫¶Ë©ï‰æ°„ÇíAI„Åå„Éâ„É©„Éï„Éà„Åó„ÄÅË¶ãËêΩ„Å®„Åó„ÇíÈò≤„Åê„ÄÇ",
                "ÁõÆÁöÑÔºö„Ç≥„É≥„Éó„É©„Ç§„Ç¢„É≥„Çπ„ÇíÁ∂≠ÊåÅ„Åó„Å™„Åå„Çâ„ÄÅÂúßÂÄíÁöÑ„Å™„Çπ„Éî„Éº„Éâ„ÇíÊâã„Å´ÂÖ•„Çå„Çã„ÄÇ"
            ]
        },
        // --- Phase 1: Create & Regulate ---
        {
            type: "case",
            title: "„ÄêR&D/RA„Äë„É™„Çπ„ÇØ„Éû„Éç„Ç∏„É°„É≥„Éà & Áî≥Ë´ãÊ∫ñÂÇô",
            subTitle: "ISO 14971Ê∫ñÊã†ÊñáÊõ∏„Å®„ÄÅPMDAÂØæÈù¢Âä©Ë®ÄË≥áÊñô„ÅÆ‰ΩúÊàêÊîØÊè¥",
            step1: { label: "Input (Ë¶èÊ†º/ÈÅéÂéª„Éá„Éº„Çø)", text: "„ÉªISO 14971Ë¶èÊ†ºÊõ∏\n„ÉªÈÅéÂéª„ÅÆFMEA/„Éè„Ç∂„Éº„ÉâÂàÜÊûêË°®\n„ÉªPMDAÂÖ¨Èñã„ÅÆÂØ©ÊüªÂ†±ÂëäÊõ∏" },
            step2: { label: "Process (AI: Claude Opus/NotebookLM)", text: "ÊäΩÂá∫Ôºö„ÄåÊñ∞Ë¶èË®≠Ë®à„Å´„Åä„Åë„Çã„Éè„Ç∂„Éº„Éâ„ÇíÊäΩÂá∫„Åó„ÄÅ„É™„Çπ„ÇØÂØæÁ≠ñÊ°à„Çí„Éâ„É©„Éï„Éà„Åó„Å¶„Äç\nÊÉ≥ÂÆöÂïèÁ≠îÔºö„ÄåÊ≤ªÈ®ì„Éó„É≠„Éà„Ç≥„É´„Å´ÂØæ„Åó„ÄÅPMDA„Åã„ÇâÊÉ≥ÂÆö„Åï„Çå„ÇãÊåáÊëò‰∫ãÈ†Ö„Å®ÂõûÁ≠îÊ°à„Çí‰ΩúÊàê„Åó„Å¶„Äç" },
            step3: { label: "Output (ÊñáÊõ∏Âåñ)", text: "FMEA„Éâ„É©„Éï„Éà‰ΩúÊàê„Å®„ÄÅÂØæÈù¢Âä©Ë®ÄQ&A„ÅÆÂç≥ÊôÇÁîüÊàê„ÄÇ\nÁõ£ÊüªÂØæÂøú„ÅÆÊäú„ÅëÊºè„ÇåÈò≤Ê≠¢„Å®Ê∫ñÂÇôÊúüÈñì„ÅÆÁü≠Á∏Æ„ÄÇ" }
        },
        // --- Phase 2: Commercialize (Sales) ---
        {
            type: "case",
            title: "„ÄêÂñ∂Ê•≠„ÄëÁóá‰æãÁ´ã„Å°‰ºö„ÅÑË®òÈå≤ & VACÁî≥Ë´ã",
            subTitle: "ÁèæÂ†¥„ÅÆ„ÄåË®òÊÜ∂„Äç„ÇíË®òÈå≤„Å´Â§â„Åà„ÄÅÈô¢ÂÜÖÊé°Áî®„ÇíÂãù„Å°Âèñ„Çã",
            step1: { label: "Input (Èü≥Â£∞/Á´∂Âêà„Éá„Éº„Çø)", text: "„ÉªË°ìÂæå„ÅÆÈü≥Â£∞„É°„É¢Ôºö„ÄåÂÖàÁîü„Åã„ÇâXX„ÅÆË®≠ÂÆöÊåáÁ§∫„ÅÇ„Çä...„Äç\n„ÉªÁ´∂ÂêàË£ΩÂìÅ„ÅÆ„Çπ„Éö„ÉÉ„ÇØÊÉÖÂ†±" },
            step2: { label: "Process (AI: Whisper/Perplexity/Genspark)", text: "ÊñáÂ≠óËµ∑„Åì„ÅóÔºöWhisper„ÅßÈü≥Â£∞„Çí„ÉÜ„Ç≠„Çπ„ÉàÂåñ„Åó„ÄÅ„Ç¢„ÇØ„Ç∑„Éß„É≥„Ç¢„Ç§„ÉÜ„É†„ÇíÊäΩÂá∫\nË≥áÊñô‰ΩúÊàêÔºö„ÄåAÁóÖÈô¢„ÅÆVACÁî≥Ë´ãÊõ∏Âºè„Å´Âêà„Çè„Åõ„Å¶„ÄÅÁ´∂ÂêàBÁ§æ„Å´ÂØæ„Åô„ÇãÂÑ™‰ΩçÊÄßÊØîËºÉË°®„Çí‰ΩúÊàê„Åó„Å¶„Äç" },
            step3: { label: "Output (ÊàêÊûú)", text: "Ë©≥Á¥∞„Å™Á´ã‰ºö„ÅÑ„É¨„Éù„Éº„Éà„ÅÆËá™ÂãïÁîüÊàê„Å®„ÄÅÊé°Áî®Áî≥Ë´ãË≥áÊñô„ÅÆÂç≥ÊôÇ„Éâ„É©„Éï„Éà„ÄÇ\n‰∫ãÂãô‰ΩúÊ•≠ÊôÇÈñì„ÇíÂâäÊ∏õ„Åó„ÄÅÂåªÂ∏´„Å®„ÅÆÂØæË©±„Å´ÈõÜ‰∏≠„ÄÇ" }
        },
        // --- Phase 3: Support (Service/Quality) ---
        {
            type: "case",
            title: "„ÄêÂìÅË≥™/„Çµ„Éº„Éì„Çπ„ÄëCAPA & „Çµ„Éº„Éì„ÇπÂ†±Âëä",
            subTitle: "‰∏çÈÅ©Âêà„ÅÆÁúüÂõ†ËøΩÊ±Ç„Å®„ÄÅÁèæÂ†¥‰ΩúÊ•≠„ÅÆË≤†ÊãÖ„Çº„É≠Âåñ",
            step1: { label: "Input (‰∏çÈÅ©Âêà„Éá„Éº„Çø/ÁèæÂ†¥Èü≥Â£∞)", text: "„ÉªË£ΩÈÄ†Ë®òÈå≤(DHR)„Å®‰∏çÈÅ©ÂêàÂ†±ÂëäÊõ∏\n„ÉªÁÇπÊ§úÊôÇ„ÅÆÈü≥Â£∞Ôºö„Äå„Éï„Ç£„É´„Çø„Éº‰∫§ÊèõÂÆå‰∫Ü„ÄÅÁï∞Èü≥„Å™„Åó„Äç" },
            step2: { label: "Process (AI: Claude Artifacts/Gemini Agent)", text: "ÂàÜÊûêÔºö„ÄåÈÅéÂéª„ÅÆ‰∏çÈÅ©Âêà‰∫ã‰æã„Åã„ÇâÊ†πÊú¨ÂéüÂõ†(Root Cause)„ÇíÊé®Ë´ñ„Åó„ÄÅCAPAÊñáÊõ∏„ÇíÊßãÊàê„Åó„Å¶„Äç\nÁîüÊàêÔºöÈü≥Â£∞Ë™çË≠ò„Å®ÊâãÊõ∏„Åç„É°„É¢„Åã„Çâ„ÄÅ„Çµ„Éº„Éì„ÇπÂÆå‰∫ÜÂ†±ÂëäÊõ∏„ÇíËá™ÂãïÁîüÊàê" },
            step3: { label: "Output (ÂìÅË≥™Âêë‰∏ä)", text: "Ë´ñÁêÜÁöÑ„Å™CAPAÊñáÊõ∏„ÅÆ‰ΩúÊàêÊîØÊè¥„Å®„ÄÅ„Çµ„Éº„Éì„Çπ„É¨„Éù„Éº„Éà‰ΩúÊàê„ÅÆËá™ÂãïÂåñ„ÄÇ\n„Ç≥„É≥„Éó„É©„Ç§„Ç¢„É≥„ÇπÈÅµÂÆà„Å®Â∑•Êï∞ÂâäÊ∏õ„ÅÆ‰∏°Á´ã„ÄÇ" }
        },
        // --- Special: Change Control ---
        {
            type: "case",
            title: "„ÄêÁâπÂà•Á∑®„ÄëÂ§âÊõ¥ÁÆ°ÁêÜ (Change Control) „ÅÆÂ£Å",
            subTitle: "„ÄåÈÉ®ÂìÅ„Å≤„Å®„Å§„Äç„ÅÆÂ§âÊõ¥„ÅåÂèä„Åº„ÅôÂΩ±Èüø„ÇíAI„ÅåÁ∂≤ÁæÖ",
            step1: { label: "Input (Â§âÊõ¥ÈÄöÁü•)", text: "„Éª„Çµ„Éó„É©„Ç§„É§„Éº„Åã„Çâ„ÅÆÈÉ®ÂìÅ‰ªïÊßòÂ§âÊõ¥ÈÄöÁü•\n„ÉªÁ§æÂÜÖ„ÅÆÂÖ®Ë®≠Ë®àÂõ≥Êõ∏(DHF/DMR)„Éá„Éº„Çø„Éô„Éº„Çπ" },
            step2: { label: "Process (AI: Cross-Doc Analysis)", text: "ÂΩ±ÈüøÂ∫¶Ë©ï‰æ°Ôºö„Äå„Åì„ÅÆÈÉ®ÂìÅÂ§âÊõ¥„Åå„ÄÅ„É™„Çπ„ÇØ„Éï„Ç°„Ç§„É´„ÄÅIFU„ÄÅÊµ∑Â§ñÁî≥Ë´ã(510k)„Å´‰∏é„Åà„ÇãÂΩ±ÈüøÁØÑÂõ≤„Çí„É™„Çπ„Éà„Ç¢„ÉÉ„Éó„Åó„Å¶„Äç\nËøΩË∑°ÔºöGensparkÁ≠â„Åß„Éà„É¨„Éº„Çµ„Éì„É™„ÉÜ„Ç£„ÇíÁ¢∫Ë™ç" },
            step3: { label: "Output (ÂÆâÂÖ®ÊÄßÊãÖ‰øù)", text: "Â§âÊõ¥ÊôÇÂΩ±ÈüøÂ∫¶Ë©ï‰æ°„É¨„Éù„Éº„Éà(Impact Assessment)„ÅÆ„Éâ„É©„Éï„Éà„ÄÇ\n‰∫∫Èñì„ÅåË¶ãËêΩ„Å®„Åó„Åå„Å°„Å™„ÄÅÊñáÊõ∏Èñì„ÅÆÊï¥ÂêàÊÄß„ÇíAI„ÅåÊãÖ‰øù„ÄÇ" }
        },
        {
            type: "concept",
            title: "„Åæ„Å®„ÇÅÔºöAI„ÅØ„Äå‰ø°È†ºÊÄß„Äç„ÅÆÁï™‰∫∫„Å´„Å™„Çã",
            content: [
                "**Create:** ÈñãÁô∫„É™„Çπ„ÇØ„ÅÆÊäΩÂá∫Êºè„Çå„ÇíÈò≤„Åê„ÄÇ",
                "**Sell:** ÁèæÂ†¥„ÅÆÂ£∞„ÇíÊ≠£Á¢∫„Å´Ë®òÈå≤„Åó„ÄÅ„Ç®„Éì„Éá„É≥„Çπ„Å´„Åô„Çã„ÄÇ",
                "**Support:** Â§âÊõ¥„Å´„Çà„ÇãÂìÅË≥™„Å∏„ÅÆÂΩ±Èüø„ÇíÁû¨ÊôÇ„Å´Ê§úÁü•„Åô„Çã„ÄÇ",
                "Next Step: „Åæ„Åö„ÅØ„ÄåÂñ∂Ê•≠/„Çµ„Éº„Éì„Çπ„ÅÆÈü≥Â£∞ÂÖ•Âäõ„Äç„Å®„ÄåÁ§æÂÜÖÊñáÊõ∏„ÅÆNotebookLMÂåñ„Äç„Åã„ÇâÈñãÂßã„Çí„ÄÇ"
            ]
        }
    ];

    // --- „Éó„É¨„Éì„É•„ÉºÁîüÊàê ---
    function renderPreview() {
        const container = document.getElementById('previewArea');
        container.innerHTML = "";
        
        slidesData.forEach((slide, index) => {
            const slideDiv = document.createElement('div');
            slideDiv.className = 'slide';
            if (slide.type === 'title') slideDiv.classList.add('title-type');
            
            slideDiv.innerHTML += `<div class="slide-number">${index + 1}</div>`;

            if (slide.type === 'title') {
                slideDiv.innerHTML += `
                    <div class="title-slide-content">
                        <div class="main-title">${slide.title.replace(/\n/g, '<br>')}</div>
                        <div class="sub-title">${slide.sub.replace(/\n/g, '<br>')}</div>
                    </div>`;
            } else if (slide.type === 'concept') {
                slideDiv.innerHTML += `<div class="slide-title">${slide.title}</div>`;
                let ul = `<ul class="bullet-list">`;
                slide.content.forEach(item => {
                    const formatted = item.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    ul += `<li>${formatted.replace(/\n/g, '<br>')}</li>`;
                });
                ul += `</ul>`;
                slideDiv.innerHTML += ul;
            } else if (slide.type === 'case') {
                slideDiv.innerHTML += `<div class="slide-title">${slide.title}</div>`;
                slideDiv.innerHTML += `<div class="slide-sub-title">${slide.subTitle}</div>`;
                slideDiv.innerHTML += `
                    <div class="process-flow">
                        <div class="step-box step-1">
                            <div class="step-label">Step-1</div>
                            <h3>${slide.step1.label}</h3>
                            <div class="step-content">${slide.step1.text.replace(/\n/g, '<br>')}</div>
                        </div>
                        <div class="arrow-container"><div class="arrow">‚ñ∂</div></div>
                        <div class="step-box step-2">
                            <div class="step-label">Step-2</div>
                            <h3>${slide.step2.label}</h3>
                            <div class="step-content">${slide.step2.text.replace(/\n/g, '<br>')}</div>
                        </div>
                        <div class="arrow-container"><div class="arrow">‚ñ∂</div></div>
                        <div class="step-box step-3">
                            <div class="step-label">Step-3</div>
                            <h3>${slide.step3.label}</h3>
                            <div class="step-content">${slide.step3.text.replace(/\n/g, '<br>')}</div>
                        </div>
                    </div>`;
            }
            container.appendChild(slideDiv);
        });
    }

    // --- PPTXÁîüÊàê ---
    function generatePPTX() {
        let pres = new PptxGenJS();
        pres.layout = 'LAYOUT_16x9';

        const colorPrimary = '0d47a1';
        const colorAccent = 'ffd700';
        const colorText = '263238';
        const colorLightText = '546e7a';
        
        // Step Colors
        const colorStep1Bg = 'e3f2fd'; const colorStep1Border = '1976d2';
        const colorStep2Bg = 'f3e5f5'; const colorStep2Border = '8e24aa';
        const colorStep3Bg = 'e8f5e9'; const colorStep3Border = '43a047';

        const fontTitle = 'Montserrat';
        const fontBody = 'Noto Sans JP';

        // Master
        pres.defineSlideMaster({
            title: 'MASTER',
            background: { color: 'FFFFFF' },
            objects: [
                { rect: { x: 0, y: 0, w: '100%', h: 0.1, fill: { type: 'linear', color1: colorPrimary, color2: colorAccent, angle: 90 } } },
            ],
            slideNumber: { x: 12.8, y: 7.0, color: colorLightText, fontSize: 12, fontFace: fontTitle }
        });

        pres.defineSlideMaster({
            title: 'TITLE_MASTER',
            background: { color: 'FFFFFF' },
            slideNumber: { x: 12.8, y: 7.0, color: colorLightText, fontSize: 12, fontFace: fontTitle }
        });

        slidesData.forEach((slideData) => {
            let slide = pres.addSlide({ masterName: slideData.type === 'title' ? 'TITLE_MASTER' : 'MASTER' });

            if (slideData.type === 'title') {
                slide.addText(slideData.title, { x: 0.8, y: 2.0, w: '85%', h: 2.5, fontSize: 40, color: colorPrimary, bold: true, fontFace: fontTitle, align: 'left', lineSpacing:48 });
                slide.addShape(pres.ShapeType.rect, { x: 0.8, y: 4.8, w: 0.1, h: 1.5, fill: colorAccent });
                slide.addText(slideData.sub, { x: 1.0, y: 4.8, w: '80%', h: 1.5, fontSize: 20, color: colorText, align: 'left', fontFace: fontBody, lineSpacing: 32 });
            } else if (slideData.type === 'concept') {
                slide.addText(slideData.title, { x: 0.8, y: 0.8, w: '90%', h: 0.8, fontSize: 32, color: colorPrimary, bold: true, fontFace: fontTitle, valign:'bottom' });
                slide.addShape(pres.ShapeType.rect, { x: 0.8, y: 1.65, w: 1.2, h: 0.05, fill: colorAccent });
                let contentText = slideData.content.map(t => t.replace(/\*\*/g, '')).join('\n\n');
                slide.addText(contentText, { x: 0.8, y: 2.2, w: '85%', h: 4.5, fontSize: 20, color: colorText, lineSpacing: 36, bullet: { color: colorAccent }, fontFace: fontBody });
            } else if (slideData.type === 'case') {
                slide.addText(slideData.title, { x: 0.8, y: 0.6, w: '90%', h: 0.8, fontSize: 30, color: colorPrimary, bold: true, fontFace: fontTitle, valign:'bottom' });
                slide.addShape(pres.ShapeType.rect, { x: 0.8, y: 1.45, w: 1.2, h: 0.05, fill: colorAccent });
                slide.addText(slideData.subTitle, { x: 0.8, y: 1.6, w: '90%', h: 0.5, fontSize: 16, color: colorLightText, fontFace: fontBody });

                const yPos = 2.5; const boxW = 3.8; const boxH = 4.0; const arrowW = 0.6;
                
                // Step 1
                slide.addShape(pres.ShapeType.rect, { x: 0.8, y: yPos, w: boxW, h: 0.1, fill: colorStep1Border });
                slide.addShape(pres.ShapeType.rect, { x: 0.8, y: yPos + 0.1, w: boxW, h: boxH, fill: colorStep1Bg });
                slide.addText("STEP-1", { x: 1.0, y: yPos + 0.3, w: boxW-0.4, fontSize: 10, color: colorLightText, fontFace: fontTitle });
                slide.addText(slideData.step1.label, { x: 1.0, y: yPos + 0.6, w: boxW-0.4, fontSize: 14, bold: true, color: colorPrimary, fontFace: fontTitle });
                slide.addText(slideData.step1.text, { x: 1.0, y: yPos + 1.1, w: boxW-0.4, h: boxH-1.2, fontSize: 12, color: colorText, valign: 'top', fontFace: fontBody });
                // Arrow
                slide.addText("‚ñ∂", { x: 4.7, y: yPos + 1.8, w: arrowW, fontSize: 24, color: colorAccent, align:'center' });
                // Step 2
                slide.addShape(pres.ShapeType.rect, { x: 5.4, y: yPos, w: boxW, h: 0.1, fill: colorStep2Border });
                slide.addShape(pres.ShapeType.rect, { x: 5.4, y: yPos + 0.1, w: boxW, h: boxH, fill: colorStep2Bg });
                slide.addText("STEP-2", { x: 5.6, y: yPos + 0.3, w: boxW-0.4, fontSize: 10, color: colorLightText, fontFace: fontTitle });
                slide.addText(slideData.step2.label, { x: 5.6, y: yPos + 0.6, w: boxW-0.4, fontSize: 14, bold: true, color: colorPrimary, fontFace: fontTitle });
                slide.addText(slideData.step2.text, { x: 5.6, y: yPos + 1.1, w: boxW-0.4, h: boxH-1.2, fontSize: 12, color: colorText, valign: 'top', fontFace: fontBody });
                // Arrow
                slide.addText("‚ñ∂", { x: 9.3, y: yPos + 1.8, w: arrowW, fontSize: 24, color: colorAccent, align:'center' });
                // Step 3
                slide.addShape(pres.ShapeType.rect, { x: 10.0, y: yPos, w: boxW, h: 0.1, fill: colorStep3Border });
                slide.addShape(pres.ShapeType.rect, { x: 10.0, y: yPos + 0.1, w: boxW, h: boxH, fill: colorStep3Bg });
                slide.addText("STEP-3", { x: 10.2, y: yPos + 0.3, w: boxW-0.4, fontSize: 10, color: colorLightText, fontFace: fontTitle });
                slide.addText(slideData.step3.label, { x: 10.2, y: yPos + 0.6, w: boxW-0.4, fontSize: 14, bold: true, color: colorPrimary, fontFace: fontTitle });
                slide.addText(slideData.step3.text, { x: 10.2, y: yPos + 1.1, w: boxW-0.4, h: boxH-1.2, fontSize: 12, color: colorText, valign: 'top', fontFace: fontBody });
            }
        });

        pres.writeFile({ fileName: 'MedTech_AI_Training.pptx' });
    }

    renderPreview();
</script>
</body>
</html>
