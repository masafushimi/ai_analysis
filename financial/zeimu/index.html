<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>税務会計事務所 AI導入効果分析ダッシュボード</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutral with Teal Accent -->
    <!-- Application Structure Plan: A tab-based navigation SPA with four main sections: 1) A high-level Dashboard showing overall impact and key areas. 2) A detailed Department Analysis section where users can select a department to view interactive charts and tables comparing pre- and post-AI efficiency. This is the core interactive component. 3) An Implementation Roadmap section visualizing the 3-phase plan using a clear, sequential layout. 4) A summary of Risks & Success Factors. This structure was chosen to guide the user from a broad overview to specific details and finally to actionable steps, making the dense report content digestible and engaging. -->
    <!-- Visualization & Content Choices: Dashboard: Donut chart for overall time savings, Bar chart for per-department savings. Department Analysis: Grouped Bar Chart to compare before/after man-hours per task, which is more intuitive than just showing savings. An interactive table provides detailed qualitative data. Roadmap/Risks: Structured HTML/Tailwind with icons for clarity and visual appeal. All choices prioritize user understanding and interaction, using Chart.js for all data visualizations. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans JP', 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .nav-button {
            transition: all 0.3s ease;
        }
        .nav-button.active {
            background-color: #0d9488; /* teal-600 */
            color: white;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .nav-button:not(.active):hover {
            background-color: #f1f5f9; /* slate-100 */
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .chart-container {
            position: relative;
            width: 100%;
            height: 320px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
                max-height: 500px;
            }
        }
        .task-table tr:hover {
            background-color: #f1f5f9; /* slate-100 */
        }
    </style>
</head>
<body class="text-slate-700">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-800">生成AI導入による税務会計事務所の業務改革</h1>
            <p class="mt-2 text-lg text-slate-600">インタラクティブ分析ダッシュボード</p>
        </header>

        <nav class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8">
            <button id="nav-dashboard" class="nav-button font-semibold py-2 px-4 rounded-lg shadow-sm" data-section="dashboard">ダッシュボード</button>
            <button id="nav-analysis" class="nav-button font-semibold py-2 px-4 rounded-lg shadow-sm" data-section="analysis">部門別分析</button>
            <button id="nav-roadmap" class="nav-button font-semibold py-2 px-4 rounded-lg shadow-sm" data-section="roadmap">導入ロードマップ</button>
            <button id="nav-risks" class="nav-button font-semibold py-2 px-4 rounded-lg shadow-sm" data-section="risks">成功の鍵とリスク</button>
        </nav>

        <main>
            <section id="dashboard" class="content-section space-y-8">
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">エグゼクティブサマリー</h2>
                    <p class="text-slate-600 leading-relaxed">
                        税務会計業界は、人材不足と業務のコモディティ化という二重の圧力に直面しています。本分析は、生成AIの戦略的導入が、これらの課題を克服し、事務所を「コンプライアンス業務の遂行」から「クライアントの経営課題解決」へとシフトさせるための強力なエンジンとなることを示します。特に定型業務が多い部門では最大70-80%の工数削減が見込まれ、創出された時間を高付加価値業務へ再配置することが、持続的成長の鍵となります。
                    </p>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-md flex flex-col justify-center items-center">
                        <h3 class="text-xl font-bold text-center mb-4">全体業務工数の削減ポテンシャル</h3>
                        <div class="chart-container w-full max-w-xs mx-auto h-64 md:h-auto">
                            <canvas id="overallSavingsChart"></canvas>
                        </div>
                    </div>
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-md">
                        <h3 class="text-xl font-bold text-center mb-4">部門別・月間削減可能時間</h3>
                        <div class="chart-container">
                            <canvas id="departmentSavingsChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <section id="analysis" class="content-section space-y-8">
                 <div class="bg-white p-6 rounded-xl shadow-md">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">部門別 業務効率化分析</h2>
                     <p class="text-slate-600 leading-relaxed mb-6">
                        ここでは、各部門の業務タスクを細分化し、生成AI導入による具体的な効率化の効果を可視化します。下のボタンから部門を選択すると、各タスクにおけるAI導入前後の月間工数の変化と、AIの具体的な活用方法、そしてそれによってもたらされる品質向上や属人性低下といった定性的な効果を確認できます。
                    </p>
                    <div id="department-selector" class="flex flex-wrap justify-center gap-2"></div>
                </div>

                <div class="grid grid-cols-1 xl:grid-cols-5 gap-8">
                    <div class="xl:col-span-3 bg-white p-6 rounded-xl shadow-md">
                        <h3 id="analysis-department-title" class="text-xl font-bold text-center mb-4">部門を選択してください</h3>
                        <div class="chart-container">
                            <canvas id="taskAnalysisChart"></canvas>
                        </div>
                    </div>
                     <div class="xl:col-span-2 bg-white p-6 rounded-xl shadow-md">
                        <h3 class="text-xl font-bold text-center mb-4">AI活用による効果</h3>
                        <div id="task-details" class="space-y-4 text-sm text-slate-600 h-[360px] md:h-[460px] overflow-y-auto p-2 border rounded-lg">
                            <p class="text-center pt-16">上のグラフまたは下の表からタスクを選択すると、詳細が表示されます。</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md overflow-x-auto">
                    <h3 class="text-xl font-bold mb-4">タスク詳細一覧</h3>
                    <table class="w-full text-sm text-left task-table">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                            <tr>
                                <th scope="col" class="px-6 py-3">タスク名</th>
                                <th scope="col" class="px-6 py-3 text-right">現状工数(H)</th>
                                <th scope="col" class="px-6 py-3 text-right">AI導入後工数(H)</th>
                                <th scope="col" class="px-6 py-3 text-right">削減率(%)</th>
                            </tr>
                        </thead>
                        <tbody id="analysis-table-body">
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="roadmap" class="content-section space-y-8">
                <div class="bg-white p-6 rounded-xl shadow-md">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">AI導入に向けた段階的実施ロードマップ</h2>
                    <p class="text-slate-600 leading-relaxed">
                        AIの導入は、一度にすべてを変えるのではなく、段階的に進めることが成功の鍵です。ここでは、リスクを管理し、着実な成果を生み出すための3段階のロードマップを提案します。各フェーズの目的、具体的なアクションプラン、そして達成度を測るための主要業績評価指標（KPI）を明確にすることで、変革プロジェクトを成功に導きます。
                    </p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-md border-t-4 border-teal-500">
                        <h3 class="text-xl font-bold mb-3">Phase 1: 基盤の自動化 (1-6ヶ月)</h3>
                        <p class="text-sm font-semibold text-slate-500 mb-4">「クイックウィン」と機運の醸成</p>
                        <ul class="space-y-3 text-sm list-disc list-inside">
                            <li><span class="font-bold">記帳代行の改革:</span> AI-OCR搭載クラウド会計ソフトを導入し、証憑のペーパーレス化を推進。</li>
                            <li><span class="font-bold">年末調整のデジタル化:</span> クラウド年末調整システムを導入し、手入力作業を撲滅。</li>
                            <li><span class="font-bold">バックオフィスの自動化:</span> 勤怠・請求システムを導入し、管理業務を効率化。</li>
                        </ul>
                        <div class="mt-4 pt-4 border-t">
                            <h4 class="font-semibold">KPIs:</h4>
                            <p class="text-sm text-slate-600">記帳代行処理時間(-50%), 年末調整処理時間(-70%), 管理工数(-40%)</p>
                        </div>
                    </div>
                     <div class="bg-white p-6 rounded-xl shadow-md border-t-4 border-sky-500">
                        <h3 class="text-xl font-bold mb-3">Phase 2: 専門業務の強化 (7-18ヶ月)</h3>
                        <p class="text-sm font-semibold text-slate-500 mb-4">「能力と品質の構築」</p>
                        <ul class="space-y-3 text-sm list-disc list-inside">
                            <li><span class="font-bold">AIナレッジベース構築:</span> 所内マニュアルや過去事例を集約し、組織の知識レベルを底上げ。</li>
                            <li><span class="font-bold">生成AIの活用標準化:</span> メール作成、議事録作成などでChatGPT等を日常的に活用。</li>
                            <li><span class="font-bold">申告・レビューの高度化:</span> AIによるチェックリスト生成、RPAによる電子申告自動化。</li>
                             <li><span class="font-bold">契約業務の標準化:</span> AI契約書レビューサービスを導入し、法務リスクを低減。</li>
                        </ul>
                         <div class="mt-4 pt-4 border-t">
                            <h4 class="font-semibold">KPIs:</h4>
                            <p class="text-sm text-slate-600">新人教育期間(-30%), 問い合わせ応答時間(-50%), エスカレーション件数(-60%)</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border-t-4 border-amber-500">
                        <h3 class="text-xl font-bold mb-3">Phase 3: 戦略的変革 (19ヶ月~)</h3>
                        <p class="text-sm font-semibold text-slate-500 mb-4">「高付加価値パートナーへの転身」</p>
                        <ul class="space-y-3 text-sm list-disc list-inside">
                             <li><span class="font-bold">プロアクティブなコンサル:</span> AI経営分析ツールを活用し、先見的なアドバイスを提供。</li>
                             <li><span class="font-bold">新規サービス創出:</span> 「AI駆動型M&A支援」など、新たな高収益サービスを開発。</li>
                             <li><span class="font-bold">価値に基づく価格設定:</span> 提供価値に応じた報酬体系（Value Pricing）へ移行。</li>
                        </ul>
                        <div class="mt-4 pt-4 border-t">
                            <h4 class="font-semibold">KPIs:</h4>
                            <p class="text-sm text-slate-600">コンサル収益割合(10%→30%), 顧客単価(+20%), 顧客維持率向上</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="risks" class="content-section space-y-8">
                 <div class="bg-white p-6 rounded-xl shadow-md">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">成功の鍵とリスクマネジメント</h2>
                     <p class="text-slate-600 leading-relaxed">
                        AI導入プロジェクトの成否は、テクノロジーそのものよりも、それをいかに組織に統合し、活用するかにかかっています。成功を確実にするためには、リーダーシップ、人材育成、セキュリティ、そして効果測定という4つの要素が不可欠です。これらを適切に管理することが、変革を成功に導くための羅針盤となります。
                    </p>
                </div>
                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-md">
                        <h3 class="text-lg font-bold mb-2">リーダーシップと戦略</h3>
                        <p class="text-sm text-slate-600">明確なビジョン（なぜやるのか）を掲げ、組織に変革の目的を浸透させる。ツール導入の目的化を防ぐ。</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md">
                        <h3 class="text-lg font-bold mb-2">人材育成とリスキリング</h3>
                        <p class="text-sm text-slate-600">AIを使いこなすための研修を実施。分析力、提案力、コミュニケーション能力といった人間ならではのスキルを強化する。</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md">
                        <h3 class="text-lg font-bold mb-2">セキュリティと倫理</h3>
                        <p class="text-sm text-slate-600">機密情報を守るため、セキュリティが担保されたAIツールを選定。最終的な判断と責任は人間が負う原則を徹底する。</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md">
                        <h3 class="text-lg font-bold mb-2">ROI測定と継続的改善</h3>
                        <p class="text-sm text-slate-600">導入前にKPIを設定し、定量的・定性的な効果を測定。PDCAサイクルを回し、継続的に改善活動を行う。</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const reportData = {
        '顧問税務部門': {
            tasks: [
                { name: '月次データチェック', current: 60, after: 20, challenge: '大量の仕訳の目視確認に時間がかかり、経験が浅いと異常値を見逃すリスクがある。', ai: 'AI搭載会計ソフトの異常値検出機能を活用。AIが過去データと比較し、異常な変動がある勘定科目を自動でハイライトする。', effect: '監査品質の向上と標準化。経験の浅い担当者でも効率的に異常点を発見でき、原因究明に集中できる。' },
                { name: '月次報告書作成', current: 40, after: 10, challenge: '毎月の定型的なデータ転記作業が非効率。資料作成に時間が割かれ、分析・考察の時間が圧迫される。', ai: '経営分析ツールとRPAの連携。会計データを自動連携し、定型レポートを自動生成。ChatGPT等で要約コメント案も作成。', effect: '報告の迅速化と質の向上。クライアント満足度も向上する。' },
                { name: '定型的な税務相談対応', current: 30, after: 5, challenge: '同じような質問に繰り返し時間を費やす。担当者によって回答のニュアンスが異なり、品質が不安定。', ai: '事務所ウェブサイトにAIチャットボットを設置。一般的な質問に24時間365日自動で一次回答する。', effect: '担当者の負担を大幅に軽減し、個別具体的な相談に集中できる。顧客満足度も向上。' },
                { name: '税務論点の調査', current: 25, after: 10, challenge: '調査に膨大な時間がかかる。ベテランの経験に依存しがちで、属人性が高い。', ai: '税務特化の生成AIやAI検索を活用。関連する法令、判例、裁決事例を瞬時に検索・要約して提示する。', effect: '調査時間を大幅に短縮し、属人性を低下させる。事務所全体の知識レベルの底上げにつながる。' },
                { name: '巡回監査・面談議事録作成', current: 20, after: 5, challenge: '議事録作成に時間がかかり、面談後のアクションが遅れる。担当者しか詳細を把握していない状況に陥りがち。', ai: 'AI議事録作成ツールを導入。面談音声を自動で文字起こし・要約し、ToDoリストも作成する。', effect: '情報共有の迅速化と徹底。担当者は対話に集中でき、顧客との関係構築が深まる。' },
                { name: '経営状況の分析・助言', current: 50, after: 25, challenge: '担当者の分析能力や経験に大きく依存する（属人性）。深い洞察や具体的な改善提案まで踏み込めていないケースが多い。', ai: '生成AIによる財務レポートの要約・分析支援。ChatGPT等にデータを入力し、経営課題や改善策のアイデアを提案させる。', effect: '提案の質の向上と標準化。経験の浅い担当者でも質の高い提案が可能になり、付加価値業務へのシフトを後押しする。' },
            ]
        },
        '記帳代行・入力部門': {
            tasks: [
                { name: '証憑受領・整理・スキャン', current: 70, after: 15, challenge: '手作業による時間浪費、紛失リスク、物理的な保管スペースの圧迫。', ai: 'AI-OCR搭載クラウド会計ソフトを導入。顧客にスマホアプリでの撮影・アップロードを依頼し、ペーパーレス化を推進。', effect: '物理的な紙の取り扱いがほぼゼロになり、劇的に効率化。担当者は確認作業に集中できる。' },
                { name: '通帳・クレカ明細入力', current: 80, after: 10, challenge: '最も時間と手間がかかる。入力ミスが頻発し、担当者の疲弊を招く。', ai: '銀行口座やクレジットカードとのAPI連携で取引明細を自動取得する。', effect: '手入力作業がなくなり、入力ミスが激減。月次報告の早期化に貢献。' },
                { name: '領収書・請求書手入力', current: 120, after: 55, challenge: '記帳代行業務の最大のボトルネック。非定型フォーマットが多く、判断に迷う。', ai: 'AI-OCRが領収書や請求書を自動で読み取り、日付、金額、取引先をデータ化する。', effect: '属人性が劇的に低下し、新人やパートでも短期間で戦力化可能。教育工数も大幅に削減。' },
                { name: '仕訳ルールの判断・適用', current: 50, after: 15, challenge: '担当者の経験と知識への依存度が高い。判断ミスが後工程で手戻りを生む。', ai: 'クラウド会計ソフトのAI自動仕訳機能を活用。AIが過去の仕訳パターンを学習し、勘定科目を自動で提案。', effect: '業務品質が標準化され、担当者による判断のブレがなくなる。ベテランのノウハウをAIが継承。' },
                { name: '入力内容の検算・突合', current: 30, after: 5, challenge: '手作業でのチェックは時間がかかり、見落としも発生する。', ai: 'RPAまたはChatGPT(Advanced Data Analysis)でデータ突合を自動化。不一致項目を自動でリストアップ。', effect: 'チェック精度が飛躍的に向上。人間の目では見逃しがちな差異も瞬時に検出し、後工程の手戻りを防止。' },
            ]
        },
        '決算・申告部門': {
            tasks: [
                { name: '決算整理仕訳の計上', current: 40, after: 10, challenge: '手作業では時間がかかり、計算ミスや計上漏れのリスクがある。', ai: '会計・税務ソフトの自動化機能をフル活用。固定資産管理システムと連携し、減価償却費仕訳を自動生成。', effect: '定型業務の時間を大幅に短縮し、計算ミス・転記ミスを撲滅。' },
                { name: '勘定科目内訳明細書作成', current: 30, after: 10, challenge: '件数が多いと非常に手間がかかる。転記ミスが発生しやすい。', ai: '会計ソフトが総勘定元帳データから勘定科目内訳明細書を自動作成する。', effect: '担当者はイレギュラーな取引の処理に集中できる。' },
                { name: '税務申告書へのデータ転記', current: 50, after: 10, challenge: '申告書様式が複雑で転記箇所が多く、別表間の連動を手計算で確認する必要がある。', ai: '会計ソフトと税務申告ソフトをAPI連携し、決算書データを自動インポート・自動反映させる。', effect: '申告書作成のリードタイムを短縮し、繁忙期の負担を大幅に軽減。申告書の正確性も向上。' },
                { name: '税務調整項目の判断', current: 40, after: 20, challenge: '税法の深い理解と経験が必要。判断ミスは税額に直接影響するため、属人性が高く、ダブルチェックが必須。', ai: '税務判断支援AIツールを活用。AIが会計データから税務調整が必要な可能性のある取引を抽出し、アラートを出す。', effect: '判断ミスのリスクを低減。AIの注意喚起で論点の見逃しを防ぎ、属人性を緩和。' },
                { name: '申告書レビュー（チェック）', current: 30, after: 15, challenge: 'レビュー者のスキルに品質が依存。繁忙期はレビュー時間が不足しがち。', ai: '生成AIで重点レビュー項目を含むカスタムチェックリストを生成。RPAで別表間の検算を自動実行。', effect: 'レビュー品質が均一化・高度化。レビュー担当者は税務判断の妥当性検証に集中できる。' },
                { name: '税制改正への対応', current: 20, after: 10, challenge: '常に最新情報をキャッチアップする必要がある。過去のやり方を踏襲してしまい、改正内容を見逃すリスク。', ai: 'ChatGPT等で最新の税制改正の概要を要約させ、所内ナレッジベースに蓄積。', effect: '情報のキャッチアップが容易になり、改正の見逃しリスクを低減。教育効率も向上。' },
            ]
        },
         '年末調整・法定調書部門': {
            tasks: [
                { name: '書類配布・回収・督促', current: 50, after: 10, challenge: '回収に時間がかかり、進捗管理が煩雑。督促業務が精神的負担。', ai: '年末調整申告のクラウドシステムを導入。従業員がPCやスマホから直接入力し、未提出者には自動でリマインド。', effect: 'ペーパーレス化を実現し、進捗管理が可視化される。担当者の精神的負担も軽減。' },
                { name: '申告書の目視チェック', current: 100, after: 20, challenge: '膨大な量の書類チェックは非常に手間。繁忙期の疲労による見落としリスクが高い。', ai: 'クラウドシステムのAIチェック機能が入力漏れや矛盾を自動でアラート。', effect: 'チェック業務を劇的に効率化し、精度を向上。担当者は例外ケースの確認に集中できる。' },
                { name: '証明書類との突合', current: 80, after: 20, challenge: '証明書のフォーマットが多様で、金額の転記ミスや添付漏れが多い。', ai: 'AI-OCRが控除証明書を読み取り、申告内容と自動で突合する。', effect: '突合業務の効率化と精度向上。クライアント（従業員）の利便性も向上。' },
                { name: '給与システムへのデータ入力', current: 120, after: 5, challenge: '最も工数がかかる単純作業。入力ミスが給与計算の誤りに直結する。', ai: '年末調整システムと給与計算ソフトをAPI連携し、データを自動で反映させる。', effect: '手入力作業を完全撤廃し、転記ミスがゼロに。繁忙期の残業時間を大幅に削減。' },
                { name: '複雑な控除の判断', current: 30, after: 15, challenge: '担当者の知識レベルに依存し、属人性が高い。判断ミスは追徴リスクに繋がる。', ai: 'AI検索機能付きの所内ナレッジベースを構築。関連事例や根拠条文をAIが提示。', effect: '判断業務を標準化し、属人化を解消。新人でもベテランの知見にアクセスでき、教育コストを削減。' },
                { name: '源泉徴収票・法定調書の作成', current: 60, after: 30, challenge: 'システムが自動作成するが、最終的な内容確認は必須。', ai: 'RPAで電子申告作業を自動化。e-Tax/eLTAXソフトへのインポートから送信までを自動実行。', effect: '申告作業を効率化し、手作業による操作ミスを防止。担当者は最終確認に集中できる。' },
            ]
        },
        '相続・資産税部門': {
            tasks: [
                 { name: '書類収集・整理・目録作成', current: 25, after: 10, challenge: '膨大な紙資料の管理が煩雑で、収集漏れや転記ミスのリスクがある。', ai: 'AI-OCRとRPAを活用。戸籍謄本や残高証明書等を読み取り、財産目録フォーマットへ自動転記。', effect: '資料整理を劇的に効率化。担当者はデータ化された情報の確認に集中でき、転記ミスも削減。' },
                 { name: '準確定申告書の作成', current: 8, after: 2, challenge: '医療費控除の領収書集計など、資料整理と入力に手間がかかる。', ai: 'AI-OCRによる医療費集計の自動化。大量の領収書を人別・病院別に自動集計。', effect: '煩雑な集計作業から解放され、計算ミスを防止。' },
                 { name: '不動産・非上場株式の評価', current: 45, after: 25, challenge: '高度な専門知識と経験を要し、属人性が極めて高い。評価ミスは税額に甚大な影響を与える。', ai: '財産評価支援AIツールを活用。AIが地図情報や財務データを基に、評価額や適用可能性を提示。', effect: '評価業務を高度化・標準化。評価減の要素の見落としを防ぎ、若手教育にも活用。' },
                 { name: '遺産分割シミュレーション', current: 12, after: 4, challenge: '手作業での試算は時間がかかり、比較できるパターンが限られる。', ai: '相続シミュレーションソフトと生成AIを連携。様々な分割パターンでの税額を瞬時に計算し、最適な案を提案。', effect: '提案の質とスピードが向上し、依頼者の意思決定を強力に支援。顧客満足度が向上。' },
            ]
        },
        'コンサルティング部門': {
            tasks: [
                 { name: '経営分析・資金繰り表作成', current: 55, after: 10, challenge: 'データ加工に時間がかかり、分析そのものに時間を割けない。予測の精度が担当者の経験に依存。', ai: 'AI搭載の経営分析・資金繰り予測ツールを導入。会計データと連携し、レポートや予測表を自動生成。', effect: '分析業務を劇的に高速化し、予測精度も向上。担当者は結果の解釈と提案に集中できる。' },
                 { name: '提案資料のドラフト作成', current: 20, after: 5, challenge: '資料の構成やデザインに時間がかかり、品質にばらつきが出る。', ai: '生成AI（ChatGPT, Gamma等）で資料構成案・スライドを自動生成。', effect: '資料作成を効率化し、品質を標準化。内容のブラッシュアップに注力できる。' },
                 { name: '経営課題の抽出と分析', current: 40, after: 20, challenge: '高度な分析能力と業界知識が必要で、属人性が非常に高い。', ai: '生成AIをデータ分析の壁打ち相手として活用。人間では気づきにくい相関関係や新たな視点を提供。', effect: '分析を多角化・深化させ、属人性を緩和。経験の浅い担当者でも深い分析の切り口を得られる。' },
                 { name: '事業承継・M&A候補先の探索', current: 30, after: 10, challenge: '探索範囲が担当者の人脈や知識に限定されがち。', ai: 'AIマッチングプラットフォームを活用。国内数百万社のデータベースから、最適な候補先をリストアップ。', effect: '探索範囲を飛躍的に拡大し、精度も向上。クライアントへの提案価値が高まる。' },
                 { name: 'コンサルティング面談準備', current: 35, after: 25, challenge: '担当者の対話力、傾聴力、提案力に成果が大きく左右される。', ai: 'AIによる面談準備とロールプレイング。過去の議事録等を基に論点を整理し、AIを経営者役に見立てて練習。', effect: '面談の質が向上し、提案力を強化できる。' },
            ]
        },
        '営業・新規顧客対応': {
            tasks: [
                { name: 'ブログ・SNSコンテンツ作成', current: 20, after: 8, challenge: 'コンテンツ作成に時間がかかり、継続が困難。ネタ切れになりがち。', ai: 'ChatGPT/Copilotでコンテンツ案・下書きを生成。', effect: '情報発信の量と質が向上し、事務所のブランディングを強化。' },
                { name: '初回問い合わせへの定型応答', current: 10, after: 1, challenge: '即時対応が難しく、機会損失につながる可能性がある。', ai: 'ウェブサイトにAIチャットボットを導入し、24時間365日自動応答・面談予約まで完結。', effect: '機会損失を防止し、顧客体験を向上。' },
                { name: '見積書・契約書の作成', current: 15, after: 5, challenge: '過去の類似案件を探すのが非効率。作成ミスも発生しうる。', ai: 'AI機能付きCRM/SFAと連携。過去データから適切な見積額を提案し、帳票を自動生成。', effect: '見積もり精度を向上・標準化し、作成ミスを削減。' },
                { name: '見込み客のニーズ把握', current: 25, after: 15, challenge: '高度なヒアリング力が必要で、担当者のスキルに依存する。', ai: 'AIによる顧客分析とインサイト抽出。問い合わせ内容等から潜在的関心事を可視化。', effect: '商談の質が向上し、より的を射た提案が可能になり、成約率も向上。' },
                { name: 'サービス提案・クロージング', current: 20, after: 15, challenge: '提案力、交渉力が求められる。', ai: '生成AIとの提案ロールプレイング。商談のシミュレーションで自主的に提案力を磨く。', effect: '営業スキルを向上させ、新人教育にも活用できる。' },
                { name: '顧客・案件情報の管理', current: 15, after: 5, challenge: '情報が属人化・分散し、組織的な営業活動ができない。', ai: 'AI機能付きCRM/SFAを導入。商談の音声データを自動で要約・登録し、受注確度の高い案件を予測。', effect: '営業活動を可視化・データドリブン化し、属人性を排除。' }
            ]
        },
        '社内バックオフィス': {
            tasks: [
                 { name: '勤怠データの集計', current: 15, after: 2, challenge: '手作業での集計は時間がかかり、計算ミスが発生しやすい。', ai: 'AI搭載の勤怠管理システムを導入。労働時間を自動集計し、過重労働の兆候をAIが検知・アラート。', effect: '労務管理を効率化し、コンプライアンスを強化。' },
                 { name: '請求書の作成・発行', current: 20, after: 3, challenge: '手作業での作成は非効率で、金額や宛先の間違いが起こりうる。', ai: '請求書発行システムを導入。請求書を自動作成・自動送付し、インボイス制度にも対応。', effect: '請求業務を完全自動化し、作成・送付の手間とコストを大幅に削減。' },
                 { name: '入金消込作業', current: 10, after: 2, challenge: '振込名義が異なる場合など、確認に手間がかかる。', ai: 'AIによる自動消込機能を活用。請求データと入金データをAIが自動で照合し、消込処理。', effect: '消込業務を高速化・高精度化し、キャッシュフロー管理を迅速化。' },
                 { name: '契約書のレビュー・管理', current: 13, after: 3, challenge: '法務知識が必要で、担当者が限定される。更新期限の見逃しリスク。', ai: 'AI契約書レビュー・管理サービスを導入。AIがリスクを指摘し、更新時期もアラートで通知。', effect: 'リーガルチェックを迅速化・品質向上させ、ガバナンスを強化。' }
            ]
        },
         '総務・庶務・教育': {
            tasks: [
                { name: '社内問合せ・新人教育', current: 45, after: 15, challenge: '同じ質問への繰り返し対応が非効率。教育担当の負担が大きく、品質も属人化。', ai: 'AI搭載の社内ナレッジベース・チャットボットを構築。マニュアル等を学習させ、質問に24時間自動応答。', effect: '業務の属人化を解消し、ナレッジを組織資産化。新人教育の負担を大幅に軽減。' },
                { name: '業務マニュアル作成・更新', current: 20, after: 5, challenge: '作成に時間がかかり、更新が追いつかず、情報が古くなりがち。', ai: 'マニュアル自動作成ツールやChatGPTを活用。PC操作の記録や指示でマニュアルを自動生成。', effect: 'マニュアル作成・更新を迅速化し、品質を向上・標準化。' },
                { name: '採用面接のスケジュール調整', current: 10, after: 1, challenge: '日程調整の往復連絡に手間がかかる。', ai: 'AIスケジューリングツールを活用。応募者と面接官の空き時間をAIが自動で調整・確定。', effect: '採用業務を効率化し、候補者体験を向上させる。' }
            ]
        }
    };
    
    let overallSavingsChart, departmentSavingsChart, taskAnalysisChart;

    const navButtons = document.querySelectorAll('.nav-button');
    const sections = document.querySelectorAll('.content-section');

    const setActiveSection = (sectionId) => {
        sections.forEach(section => {
            section.classList.toggle('active', section.id === sectionId);
        });
        navButtons.forEach(button => {
            button.classList.toggle('active', button.dataset.section === sectionId);
        });
        window.scrollTo(0, 0);
    };

    navButtons.forEach(button => {
        button.addEventListener('click', () => {
            setActiveSection(button.dataset.section);
        });
    });

    const init = () => {
        createDepartmentSelector();
        createOverallSavingsChart();
        createDepartmentSavingsChart();
        setActiveSection('dashboard');
        updateDepartmentAnalysis(Object.keys(reportData)[0]); 
    };
    
    const calculateTotals = () => {
        let totalCurrent = 0;
        let totalAfter = 0;
        const departmentTotals = {};

        for (const dept in reportData) {
            let deptCurrent = 0;
            let deptAfter = 0;
            reportData[dept].tasks.forEach(task => {
                deptCurrent += task.current;
                deptAfter += task.after;
            });
            totalCurrent += deptCurrent;
            totalAfter += deptAfter;
            departmentTotals[dept] = { current: deptCurrent, after: deptAfter, saved: deptCurrent - deptAfter };
        }
        return { totalCurrent, totalAfter, departmentTotals };
    };

    const formatLabel = (str, maxLen = 16) => {
        if (str.length <= maxLen) return str;
        return str.substring(0, maxLen) + '...';
    };

    const createOverallSavingsChart = () => {
        const { totalCurrent, totalAfter } = calculateTotals();
        const ctx = document.getElementById('overallSavingsChart').getContext('2d');
        if (overallSavingsChart) overallSavingsChart.destroy();
        overallSavingsChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['削減可能時間', '残存業務時間'],
                datasets: [{
                    data: [totalCurrent - totalAfter, totalAfter],
                    backgroundColor: ['#0d9488', '#cbd5e1'],
                    borderColor: '#f8fafc',
                    borderWidth: 4,
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.label || '';
                                if (label) label += ': ';
                                if (context.parsed !== null) {
                                    const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                    const percentage = ((context.parsed / total) * 100).toFixed(1);
                                    label += `${context.parsed}時間 (${percentage}%)`;
                                }
                                return label;
                            }
                        }
                    }
                }
            }
        });
    };
    
    const createDepartmentSavingsChart = () => {
        const { departmentTotals } = calculateTotals();
        const labels = Object.keys(departmentTotals);
        const data = labels.map(label => departmentTotals[label].saved);
        const ctx = document.getElementById('departmentSavingsChart').getContext('2d');
        if (departmentSavingsChart) departmentSavingsChart.destroy();
        departmentSavingsChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels.map(l => l.replace('部門', '')),
                datasets: [{
                    label: '月間削減可能時間 (H)',
                    data: data,
                    backgroundColor: '#14b8a6', // teal-500
                    borderColor: '#0d9488', // teal-600
                    borderWidth: 1,
                    borderRadius: 4,
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: (context) => `${context.parsed.x} 時間`
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        title: { display: true, text: '削減可能時間 (時間/月)' }
                    }
                }
            }
        });
    };

    const createDepartmentSelector = () => {
        const selectorContainer = document.getElementById('department-selector');
        Object.keys(reportData).forEach((deptName, index) => {
            const button = document.createElement('button');
            button.textContent = deptName;
            button.className = 'dept-selector-btn text-sm py-2 px-3 rounded-md transition-colors duration-200';
            if (index === 0) {
                button.classList.add('bg-teal-600', 'text-white', 'font-semibold');
            } else {
                button.classList.add('bg-slate-100', 'hover:bg-slate-200');
            }
            button.addEventListener('click', () => {
                document.querySelectorAll('.dept-selector-btn').forEach(btn => {
                    btn.classList.remove('bg-teal-600', 'text-white', 'font-semibold');
                    btn.classList.add('bg-slate-100', 'hover:bg-slate-200');
                });
                button.classList.add('bg-teal-600', 'text-white', 'font-semibold');
                button.classList.remove('bg-slate-100', 'hover:bg-slate-200');
                updateDepartmentAnalysis(deptName);
            });
            selectorContainer.appendChild(button);
        });
    };

    const updateDepartmentAnalysis = (deptName) => {
        const departmentData = reportData[deptName];
        document.getElementById('analysis-department-title').textContent = `${deptName} の業務分析`;

        const ctx = document.getElementById('taskAnalysisChart').getContext('2d');
        if (taskAnalysisChart) {
            taskAnalysisChart.destroy();
        }

        const labels = departmentData.tasks.map(task => task.name.split('・'));

        taskAnalysisChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: '現状工数 (H)',
                        data: departmentData.tasks.map(task => task.current),
                        backgroundColor: '#64748b', // slate-500
                        borderColor: '#475569', // slate-600
                        borderWidth: 1,
                        borderRadius: 4,
                    },
                    {
                        label: 'AI導入後工数 (H)',
                        data: departmentData.tasks.map(task => task.after),
                        backgroundColor: '#14b8a6', // teal-500
                        borderColor: '#0d9488', // teal-600
                        borderWidth: 1,
                        borderRadius: 4,
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                onClick: (event, elements) => {
                    if (elements.length > 0) {
                        const index = elements[0].index;
                        updateTaskDetails(departmentData.tasks[index]);
                    }
                },
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                    },
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: '月間工数 (時間)'
                        }
                    },
                    x: {
                        ticks: {
                            font: {
                                size: 10
                            }
                        }
                    }
                }
            }
        });
        updateAnalysisTable(departmentData.tasks);
        updateTaskDetails(null); // Clear details
    };
    
    const updateAnalysisTable = (tasks) => {
        const tableBody = document.getElementById('analysis-table-body');
        tableBody.innerHTML = '';
        tasks.forEach((task, index) => {
            const row = document.createElement('tr');
            row.className = 'bg-white border-b cursor-pointer';
            
            const saved = task.current - task.after;
            const percentage = task.current > 0 ? ((saved / task.current) * 100).toFixed(0) : 0;
            
            row.innerHTML = `
                <td class="px-6 py-4 font-medium text-slate-900">${task.name}</td>
                <td class="px-6 py-4 text-right">${task.current}</td>
                <td class="px-6 py-4 text-right">${task.after}</td>
                <td class="px-6 py-4 text-right text-teal-600 font-semibold">${percentage}%</td>
            `;
            row.addEventListener('click', () => updateTaskDetails(task));
            tableBody.appendChild(row);
        });
    };

    const updateTaskDetails = (task) => {
        const detailsContainer = document.getElementById('task-details');
        if (task) {
            detailsContainer.innerHTML = `
                <div class="space-y-3">
                    <h4 class="font-bold text-base text-slate-800">${task.name}</h4>
                    <div>
                        <h5 class="font-semibold text-sm text-red-600">現状の課題</h5>
                        <p>${task.challenge}</p>
                    </div>
                    <div>
                        <h5 class="font-semibold text-sm text-sky-600">AI活用方法</h5>
                        <p>${task.ai}</p>
                    </div>
                    <div>
                        <h5 class="font-semibold text-sm text-green-600">定性的効果</h5>
                        <p>${task.effect}</p>
                    </div>
                </div>
            `;
        } else {
             detailsContainer.innerHTML = '<p class="text-center pt-16">上のグラフまたは下の表からタスクを選択すると、詳細が表示されます。</p>';
        }
    };
    
    init();

});
</script>

</body>
</html>
