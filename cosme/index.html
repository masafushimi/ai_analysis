<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂåñÁ≤ßÂìÅ„É°„Éº„Ç´„ÉºÁîüÊàêAIÊ¥ªÁî®„Çπ„É©„Ç§„Éâ (Pro Design)</title>
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* ÂåñÁ≤ßÂìÅÊ•≠ÁïåÂêë„Åë„Å´Â∞ë„Åó„Ç®„É¨„Ç¨„É≥„Éà„Åï„ÇíÊÑèË≠ò„Åó„Åü„Ç´„É©„Éº„Éë„É¨„ÉÉ„Éà */
            --primary-color: #1a237e; /* „Éá„Ç£„Éº„Éó„Éç„Ç§„Éì„ÉºÔºà‰ø°È†ºÔºâ */
            --accent-color: #c5a572;  /* „Ç∑„É£„É≥„Éë„É≥„Ç¥„Éº„É´„ÉâÔºàÈ´òÁ¥öÊÑüÔºâ */
            --text-color: #333333;
            --light-text: #666666;
            --bg-color: #f0f2f5;
            --slide-bg: #ffffff;
            
            /* Step Colors */
            --step1-bg: #f8f9fa; --step1-border: #5c6bc0;
            --step2-bg: #fdfbf7; --step2-border: #8d6e63; /* AIÊÄùËÄÉ„Éó„É≠„Çª„Çπ„ÅØÂ∞ë„ÅóÊ∏©„Åã„Åø„ÅÆ„ÅÇ„ÇãËâ≤„Å∏ */
            --step3-bg: #f1f8e9; --step3-border: #66bb6a;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 40px 20px;
            color: var(--text-color);
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            text-align: center;
        }

        h1.page-title {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
        }

        .controls {
            margin-bottom: 40px;
            padding: 25px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            display: inline-block;
        }

        button.download-btn {
            background: linear-gradient(135deg, var(--primary-color), #283593);
            color: white;
            border: none;
            padding: 16px 36px;
            font-size: 18px;
            font-weight: 700;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            font-family: 'Montserrat', sans-serif;
            box-shadow: 0 4px 10px rgba(26, 35, 126, 0.3);
        }

        button.download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(26, 35, 126, 0.4);
        }

        .slide-preview-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            align-items: center;
        }

        .slide {
            width: 960px; /* 16:9 */
            height: 540px;
            background: var(--slide-bg);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            padding: 50px;
            box-sizing: border-box;
            text-align: left;
            overflow: hidden;
            border-radius: 4px;
        }

        /* „Ç¢„ÇØ„Çª„É≥„Éà„É©„Ç§„É≥ */
        .slide::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, var(--primary-color) 60%, var(--accent-color) 100%);
        }

        .slide-number {
            position: absolute;
            bottom: 15px;
            right: 25px;
            color: var(--light-text);
            font-size: 14px;
            font-family: 'Montserrat', sans-serif;
        }

        .slide-title {
            font-size: 32px;
            color: var(--primary-color);
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            margin-bottom: 25px;
            position: relative;
            padding-bottom: 15px;
            line-height: 1.3;
        }
        
        .slide-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background-color: var(--accent-color);
        }

        .slide-sub-title {
            font-size: 18px;
            color: var(--light-text);
            font-weight: 500;
            margin-top: -15px;
            margin-bottom: 25px;
        }

        .process-flow {
            display: flex;
            justify-content: space-between;
            align-items: stretch;
            height: 300px;
            margin-top: 10px;
            gap: 15px;
        }

        .step-box {
            flex: 1;
            border-radius: 8px;
            padding: 18px;
            display: flex;
            flex-direction: column;
            font-size: 14px;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            background-color: white;
        }

        .step-box h3 {
            margin-top: 5px;
            font-size: 16px;
            color: var(--primary-color);
            margin-bottom: 10px;
            font-weight: 700;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            padding-bottom: 8px;
        }

        .step-1 { background-color: var(--step1-bg); border-top: 4px solid var(--step1-border); }
        .step-2 { background-color: var(--step2-bg); border-top: 4px solid var(--step2-border); }
        .step-3 { background-color: var(--step3-bg); border-top: 4px solid var(--step3-border); }

        .arrow-container {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 20px;
        }
        
        .arrow {
            font-size: 20px;
            color: var(--accent-color);
        }

        .step-content {
            flex-grow: 1;
            line-height: 1.5;
            white-space: pre-wrap;
        }
        
        .step-label {
            font-size: 11px;
            text-transform: uppercase;
            color: #888;
            margin-bottom: 4px;
            font-weight: 600;
            font-family: 'Montserrat', sans-serif;
            letter-spacing: 0.05em;
        }

        /* Title Slide specific */
        .title-slide-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 100%;
            padding-left: 20px;
        }
        .slide.title-type::before { background: none; }
        .main-title { 
            font-size: 46px; 
            color: var(--primary-color); 
            margin-bottom: 25px; 
            font-weight: 800; 
            font-family: 'Montserrat', sans-serif;
            line-height: 1.2;
        }
        .sub-title { 
            font-size: 22px; 
            color: var(--text-color); 
            line-height: 1.6;
            border-left: 5px solid var(--accent-color);
            padding-left: 25px;
        }

        /* List styles */
        .bullet-list { padding-left: 30px; margin-top: 20px; }
        .bullet-list li { 
            margin-bottom: 18px; 
            font-size: 20px; 
            line-height: 1.6;
            color: var(--text-color);
        }
        .bullet-list li strong { color: var(--primary-color); }
        .bullet-list li::marker { color: var(--accent-color); }

    </style>
</head>
<body>

<div class="container">
    <h1 class="page-title">ÂåñÁ≤ßÂìÅ„É°„Éº„Ç´„Éº‰∫ã‰æã„Çπ„É©„Ç§„ÉâÁîüÊàê (Pro Design)</h1>
    <div class="controls">
        <p>‰ª•‰∏ã„ÅÆ„Éú„Çø„É≥„Åß„ÄÅPowerPoint (.pptx) „Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åß„Åç„Åæ„Åô„ÄÇ</p>
        <button class="download-btn" onclick="generatePPTX()">
            üì• PowerPoint (.pptx) „Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
        </button>
    </div>

    <div class="slide-preview-container" id="previewArea"></div>
</div>

<script>
    // --- „Çπ„É©„Ç§„Éâ„Éá„Éº„ÇøÂÆöÁæ©ÔºàÂåñÁ≤ßÂìÅ„É°„Éº„Ç´„Éº‰∫ã‰æãÔºâ ---
    const slidesData = [
        {
            type: "title",
            title: "ÂåñÁ≤ßÂìÅ„É°„Éº„Ç´„Éº„Å´„Åä„Åë„Çã\nÁîüÊàêAIÊ¥ªÁî®„Å®Ê•≠ÂãôÂ§âÈù©",
            sub: "„ÄåËñ¨Ê©üÊ≥ï„Äç„Å®„Äå„ÇØ„É™„Ç®„Ç§„ÉÜ„Ç£„Éñ„Äç„Çí‰∏°Á´ã„Åï„Åõ„ÄÅ\n‰ºÅÁîª„Åã„ÇâÂ∫óÈ†≠„Åæ„Åß„Çí‰∏ÄÊ∞óÈÄöË≤´„ÅßÂä†ÈÄü„Åô„Çã"
        },
        {
            type: "concept",
            title: "AIÊ¥ªÁî®„Å´„Åä„Åë„Çã3„Å§„ÅÆ„Éú„Éà„É´„Éç„ÉÉ„ÇØËß£Ê∂à",
            content: [
                "**1. Ëñ¨‰∫ã„ÉªÊ≥ïÂãô„ÅÆÂ£Å:** Âé≥Ê†º„Å™Ë¶èÂà∂„Å®„ÄÅÈ≠ÖÂäõÁöÑ„Å™Ë°®Áèæ„ÅÆÊùøÊåü„Åø„ÇíËß£Ê∂à„ÄÇ\nAI„Åå„ÄåË®Ä„Åà„ÇãÁØÑÂõ≤„ÅÆÊúÄÂ§ßÈôê„Äç„ÇíÊèêÊ°à„ÄÇ",
                "**2. „Éà„É¨„É≥„ÉâÂàÜÊûê„ÅÆÂ£Å:** Áßª„ÇäÂ§â„Çè„Çä„ÅÆÊó©„ÅÑÁæéÂÆπ„Éà„É¨„É≥„Éâ„ÇíÊçïÊçâ„ÄÇ\n„Éõ„ÉØ„Ç§„Éà„Çπ„Éö„Éº„ÇπÔºàÊú™ÈñãÊãìÈ†òÂüüÔºâ„Çí„Éá„Éº„Çø„ÅßÁô∫Ë¶ã„ÄÇ",
                "**3. Â∞ÇÈñÄÁü•Ë≠ò„ÅÆÂ£Å:** R&D„ÇÑË¶èÂà∂ÊÉÖÂ†±„ÅÆÂ±û‰∫∫Âåñ„ÇíÊâìÁ†¥„ÄÇ\nNotebookLMÁ≠â„ÅßÊäÄË°ìÊÉÖÂ†±„ÇíÁ§æÂÜÖ„Éä„É¨„ÉÉ„Ç∏Âåñ„ÄÇ",
            ]
        },
        {
            type: "case",
            title: "„Äê„Éú„Éà„É´„Éç„ÉÉ„ÇØËß£Ê∂à„ÄëËñ¨Ê©üÊ≥ï vs „Éû„Éº„Ç±„ÉÜ„Ç£„É≥„Ç∞",
            subTitle: "Ê≥ïÂãô„ÉÅ„Çß„ÉÉ„ÇØ„ÅÆÂ∑Æ„ÅóÊàª„Åó„ÇíÊ∏õ„Çâ„Åó„ÄÅ„ÇØ„É™„Ç®„Ç§„ÉÜ„Ç£„Éñ„ÇíÊ≠¢„ÇÅ„Å™„ÅÑ",
            step1: { label: "Input (Ë™≤È°å)", text: "„Éû„Éº„Ç±ÊãÖÂΩì„ÄåÂäπÊûú„ÇíÂº∑„ÅèË®Ä„ÅÑ„Åü„ÅÑ„Äç\nÊ≥ïÂãôÊãÖÂΩì„ÄåËñ¨Ê©üÊ≥ïÈÅïÂèç„Å´„Å™„Çã„Äç\n\nÁµêÊûúÔºö‰øÆÊ≠£„ÅÆÂæÄÂæ©„Åß„É≠„Éº„É≥„ÉÅ„ÅåÈÅÖ„Çå„Çã„ÄÇ" },
            step2: { label: "Process (AI: Claude/ChatGPT)", text: "ÊåáÁ§∫Ôºö„ÄåÂåñÁ≤ßÂìÅ„ÅßË®Ä„Åà„ÇãÂäπËÉΩÁØÑÂõ≤ÂÜÖ„Åß„ÄÅ„Çø„Éº„Ç≤„ÉÉ„ÉàÔºà30‰ª£‰πæÁá•ËÇåÔºâ„Å´Âà∫„Åï„ÇãÈ≠ÖÂäõÁöÑ„Å™Ë®Ä„ÅÑÊèõ„ÅàË°®Áèæ„Çí10ÂÄãÊèêÊ°à„Åó„Å¶„Äç\n\nÊ©üËÉΩÔºö„Éö„É´„ÇΩ„ÉäÔºàÊ≥ïÂãôÂü∫Ê∫ñÔºâ„ÅÆË®≠ÂÆö" },
            step3: { label: "Output (Ëß£Ê±∫)", text: "Ê≥ïÂãô„ÉÅ„Çß„ÉÉ„ÇØ„ÇíÈÄöÈÅé„Åó„ÇÑ„Åô„ÅÑ„ÄåË®Ä„ÅÑÊèõ„Åà„ÅÆÂºï„ÅçÂá∫„Åó„Äç„ÇíÂç≥Â∫ß„Å´Áç≤Âæó„ÄÇ\n\nÂäπÊûúÔºöË°®ÁèæË™øÊï¥„Ç≥„Çπ„Éà„ÅÆÂ§ßÂπÖÂâäÊ∏õ„Å®„ÄÅËøÖÈÄü„Å™Â∫ÉÂëäÂ±ïÈñã„ÄÇ" }
        },
        {
            type: "case",
            title: "„ÄêÂïÜÂìÅ‰ºÅÁîª„ÉªR&D„Äë„Éà„É¨„É≥„ÉâÂàÜÊûê„Å®Á†îÁ©∂„ÅÆÂä†ÈÄü",
            subTitle: "ÊÑüË¶ö„Å´È†º„Çâ„Å™„ÅÑ„ÄåÂ£≤„Çå„Çã„Äç‰ºÅÁîª„Å®„ÄÅÁ†îÁ©∂„Éá„Éº„Çø„ÅÆÈ´òÈÄüÂá¶ÁêÜ",
            step1: { label: "Input („Éá„Éº„Çø)", text: "„ÉªPerplexity„ÅßÂ∏ÇÂ†¥„ÅÆ„ÄåÈöôÈñì„Äç„ÇíÊ§úÁ¥¢\n„ÉªNotebookLM„Å´Êï∞Áôæ„ÅÆË´ñÊñá„ÉªÁâπË®±ÊñáÊõ∏„ÇíÊäïÂÖ•" },
            step2: { label: "Process (AI: Perplexity/NotebookLM)", text: "ÂàÜÊûêÔºö„ÄåÁ´∂Âêà„Åå„ÅÑ„Å™„ÅÑ„Éõ„ÉØ„Ç§„Éà„Çπ„Éö„Éº„Çπ„ÅØ„Å©„Åì„ÅãÔºü„Äç\nÊäΩÂá∫Ôºö„Äå„Åì„ÅÆÊàêÂàÜ„ÅÆÈÖçÂêàÁ¶ÅÂøå„Å®ÁâπË®±„É™„Çπ„ÇØ„ÇíË¶ÅÁ¥Ñ„Åó„Å¶„Äç" },
            step3: { label: "Output (ÊàêÊûú)", text: "Ê†πÊã†„ÅÇ„Çã‰ºÅÁîªÊõ∏„ÅÆ‰ΩúÊàê„Å®„ÄÅË¶èÊ†ºÂÄ§Ë®≠ÂÆöÔºàÂÆâÂÆöÊÄß‰∫àÊ∏¨Ôºâ„ÅÆËøÖÈÄüÂåñ„ÄÇ\n\nÂäπÊûúÔºö„É™„Çµ„Éº„ÉÅÊôÇÈñì80%ÂâäÊ∏õ„ÄÅÁ†îÁ©∂ËÄÖ„ÅÆÊôÇÈñì„ÇíÂÆüÈ®ì„Å´ÈõÜ‰∏≠„ÄÇ" }
        },
        {
            type: "case",
            title: "„ÄêËñ¨‰∫ã„ÉªÂìÅË≥™‰øùË®º„ÄëË§áÈõë„Å™Ë¶èÂà∂ÂØæÂøú„ÅÆËá™ÂãïÂåñ",
            subTitle: "Êµ∑Â§ñÂ±ïÈñãÔºàNMPA/CPNPÔºâ„ÇÑÂ±äÂá∫Ê•≠Âãô„ÅÆ„Éü„Çπ„Çº„É≠„Å∏",
            step1: { label: "Input (Ë¶èÂà∂ÊÉÖÂ†±)", text: "„ÉªÂÖ®ÊàêÂàÜË°®Á§∫„É™„Çπ„Éà\n„ÉªÂêÑÂõΩ„ÅÆÊúÄÊñ∞Ë¶èÂà∂„Éá„Éº„ÇøÔºàNMPAÁ≠âÔºâ" },
            step2: { label: "Process (AI: Claude/Perplexity)", text: "‰ΩúÊàêÔºö„ÄåGQPÊâãÈ†ÜÊõ∏„Å´Âü∫„Å•„Åç„ÄÅÂ§âÊõ¥Â±ä„ÅÆ„Éâ„É©„Éï„Éà„Çí‰ΩúÊàê„Åó„Å¶„Äç\nË™øÊüªÔºö„Äå‰∏≠ÂõΩ„ÅÆÊúÄÊñ∞Ë¶èÂà∂„ÅßÁ¶ÅÊ≠¢„Åï„Çå„ÅüÊàêÂàÜ„ÅåÂê´„Åæ„Çå„Å¶„ÅÑ„Å™„ÅÑ„Åã„ÉÅ„Çß„ÉÉ„ÇØ„Äç" },
            step3: { label: "Output (ÂìÅË≥™)", text: "Ê≠£Á¢∫„Å™Ê≥ïÁöÑÊñáÊõ∏„ÅÆ„Éâ„É©„Éï„ÉàÂÆåÊàê„Å®„ÄÅ„Ç≥„É≥„Éó„É©„Ç§„Ç¢„É≥„Çπ„É™„Çπ„ÇØ„ÅÆÊ§úÁü•„ÄÇ\n\nÂäπÊûúÔºöÁî≥Ë´ãÊ•≠Âãô„ÅÆÂ∑•Êï∞ÂâäÊ∏õ„Å®„ÄÅÊ≥ïË¶èÂà∂Ë™øÊüª„ÅÆÊºè„ÇåÈò≤Ê≠¢„ÄÇ" }
        },
        {
            type: "case",
            title: "„ÄêÂñ∂Ê•≠„ÉªË≤©‰øÉ„ÄëPOS„Éá„Éº„ÇøÂàÜÊûê„Å®Ê£öÂâ≤„ÇäÊèêÊ°à",
            subTitle: "„Éá„Éº„Çø„Å´Âü∫„Å•„ÅÑ„Åü„ÄåÂ£≤„Çå„ÇãÂ£≤„ÇäÂ†¥„Äç„ÇíÂ∞èÂ£≤Â∫ó„Å∏ÊèêÊ°à",
            step1: { label: "Input (POS„Éá„Éº„Çø)", text: "„ÉªÂ∫óËàó„Åî„Å®„ÅÆÂ£≤‰∏äÊé®Áßª„Éá„Éº„Çø\n„ÉªÁ´∂ÂêàÂïÜÂìÅ„ÅÆÈÖçËç∑Áä∂Ê≥Å" },
            step2: { label: "Process (AI: Gemini/ChatGPT)", text: "ÂàÜÊûêÔºö„ÄåÂú®Â∫´ÂõûËª¢Áéá„ÅåÊÇ™„ÅÑË¶ÅÂõ†„Å®„ÄÅÊòØÊ≠£„Åô„Çã„Åü„ÇÅ„ÅÆÊ£öÂâ≤„ÇäÔºà„Éó„É©„Éé„Ç∞„É©„É†ÔºâÊ°à„Çí‰ΩúÊàê„Åó„Å¶„Äç\n\n„ÉÑ„Éº„É´ÔºöExcel/SlidesÁµ±ÂêàÊ©üËÉΩ" },
            step3: { label: "Output (ÂïÜË´á)", text: "Â∫óËàó„Åî„Å®„ÅÆ„Ç´„Çπ„Çø„É†ÊèêÊ°àË≥áÊñô„ÇíËá™ÂãïÁîüÊàê„ÄÇ\n\nÂäπÊûúÔºöÂïÜË´áÊ∫ñÂÇôÊôÇÈñì„ÅÆÂ§ßÂπÖÁü≠Á∏Æ„Å®„ÄÅÈÖçËç∑Áéá„ÅÆÂêë‰∏ä„ÄÇ" }
        },
        {
            type: "case",
            title: "„Äê„Éä„É¨„ÉÉ„Ç∏„ÉªÊïôËÇ≤„ÄëÂüã„ÇÇ„Çå„ÅüÊäÄË°ì„ÇíË≥áÁî£Âåñ",
            subTitle: "Êñ∞‰∫∫ÊïôËÇ≤„Å®ÁèæÂ†¥Ë®òÈå≤Ôºà„É©„Ç¶„É≥„ÉÄ„ÉºÊ•≠ÂãôÔºâ„ÅÆÂäπÁéáÂåñ",
            step1: { label: "Input (Èü≥Â£∞„ÉªÊñáÊõ∏)", text: "„Éª„É©„Ç¶„É≥„ÉÄ„Éº„ÅÆÂ∫óÈ†≠„Éí„Ç¢„É™„É≥„Ç∞Èü≥Â£∞\n„ÉªËÜ®Â§ß„Å™ÊäÄË°ì„Éû„Éã„É•„Ç¢„É´" },
            step2: { label: "Process (AI: Whisper/NotebookLM)", text: "ÊñáÂ≠óËµ∑„Åì„ÅóÔºöWhisper„Åß‰ºöË≠∞„ÉªÂïÜË´á„Çí„ÉÜ„Ç≠„Çπ„ÉàÂåñ\nÂ≠¶ÁøíÔºö„Äå„Åì„ÅÆÊäÄË°ì‰ªïÊßòÊõ∏„ÅÆÂÜÖÂÆπ„Çí„ÄÅÊñ∞‰∫∫„ÅåÁêÜËß£„Åß„Åç„Çã„Çà„ÅÜÈü≥Â£∞Ëß£Ë™¨Ôºà„Éù„ÉÉ„Éâ„Ç≠„É£„Çπ„ÉàÔºâ„Å´„Åó„Å¶„Äç" },
            step3: { label: "Output (ÂÖ±Êúâ)", text: "Ë≠∞‰∫ãÈå≤‰ΩúÊàê„Çº„É≠Âåñ„Å®„ÄÅ„Çè„Åã„Çä„ÇÑ„Åô„ÅÑÊïôËÇ≤„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅÆÁîüÊàê„ÄÇ\n\nÂäπÊûúÔºöÊÉÖÂ†±„ÅÆÈÄèÊòéÂåñ„Å®Â≠¶Áøí„Ç≥„Çπ„Éà„ÅÆÂâäÊ∏õ„ÄÇ" }
        },
        {
            type: "concept",
            title: "„Åæ„Å®„ÇÅÔºöAI„ÅØ„ÄåÂ∞ÇÈñÄÊÄß„Äç„ÇíÊ∞ë‰∏ªÂåñ„Åô„Çã",
            content: [
                "**Input (Â∞ÇÈñÄÁü•Ë≠ò):** Á†îÁ©∂„Éá„Éº„Çø„ÄÅÊ≥ïË¶èÂà∂„ÄÅPOS„Éá„Éº„Çø„ÅØ‰∫∫Èñì„ÅåÁÆ°ÁêÜ„ÄÇ",
                "**Process (AI):** Ë§áÈõë„Å™ÂàÜÊûê„ÄÅË¶ÅÁ¥Ñ„ÄÅ„Éâ„É©„Éï„Éà‰ΩúÊàê„ÄÅË®Ä„ÅÑÊèõ„Åà„ÇíÊãÖÂΩì„ÄÇ",
                "**Output (‰æ°ÂÄ§):** ‰∫∫Èñì„ÅØ„ÄåÊÑèÊÄùÊ±∫ÂÆö„Äç„Å®„Äå„ÅäÂÆ¢Êßò„Å∏„ÅÆÊÉÖÁ∑íÁöÑ‰æ°ÂÄ§„Äç„Å´ÈõÜ‰∏≠„ÄÇ",
                "Next Step: „Åæ„Åö„ÅØ„ÄåËñ¨Ê©üÊ≥ï„ÉÅ„Çß„ÉÉ„ÇØ„Äç„Å®„ÄåË≠∞‰∫ãÈå≤„Äç„Åã„Çâ„Çπ„É¢„Éº„É´„Çπ„Çø„Éº„Éà„Çí„ÄÇ"
            ]
        }
    ];

    // --- HTML„Éó„É¨„Éì„É•„ÉºÊèèÁîª ---
    function renderPreview() {
        const container = document.getElementById('previewArea');
        container.innerHTML = "";
        
        slidesData.forEach((slide, index) => {
            const slideDiv = document.createElement('div');
            slideDiv.className = 'slide';
            if (slide.type === 'title') slideDiv.classList.add('title-type');
            
            slideDiv.innerHTML += `<div class="slide-number">${index + 1}</div>`;

            if (slide.type === 'title') {
                slideDiv.innerHTML += `
                    <div class="title-slide-content">
                        <div class="main-title">${slide.title.replace(/\n/g, '<br>')}</div>
                        <div class="sub-title">${slide.sub.replace(/\n/g, '<br>')}</div>
                    </div>`;
            } else if (slide.type === 'concept') {
                slideDiv.innerHTML += `<div class="slide-title">${slide.title}</div>`;
                let ul = `<ul class="bullet-list">`;
                slide.content.forEach(item => {
                    // BoldÂá¶ÁêÜ (**text**)
                    const formatted = item.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    ul += `<li>${formatted.replace(/\n/g, '<br>')}</li>`;
                });
                ul += `</ul>`;
                slideDiv.innerHTML += ul;
            } else if (slide.type === 'case') {
                slideDiv.innerHTML += `<div class="slide-title">${slide.title}</div>`;
                slideDiv.innerHTML += `<div class="slide-sub-title">${slide.subTitle}</div>`;
                slideDiv.innerHTML += `
                    <div class="process-flow">
                        <div class="step-box step-1">
                            <div class="step-label">Step-1</div>
                            <h3>${slide.step1.label}</h3>
                            <div class="step-content">${slide.step1.text.replace(/\n/g, '<br>')}</div>
                        </div>
                        <div class="arrow-container"><div class="arrow">‚ñ∂</div></div>
                        <div class="step-box step-2">
                            <div class="step-label">Step-2</div>
                            <h3>${slide.step2.label}</h3>
                            <div class="step-content">${slide.step2.text.replace(/\n/g, '<br>')}</div>
                        </div>
                        <div class="arrow-container"><div class="arrow">‚ñ∂</div></div>
                        <div class="step-box step-3">
                            <div class="step-label">Step-3</div>
                            <h3>${slide.step3.label}</h3>
                            <div class="step-content">${slide.step3.text.replace(/\n/g, '<br>')}</div>
                        </div>
                    </div>`;
            }
            container.appendChild(slideDiv);
        });
    }

    // --- PPTXÁîüÊàêÂá¶ÁêÜ ---
    function generatePPTX() {
        let pres = new PptxGenJS();
        pres.layout = 'LAYOUT_16x9';

        // Colors & Fonts
        const colorPrimary = '1A237E'; 
        const colorAccent = 'C5A572';
        const colorText = '333333';
        const colorLightText = '666666';
        
        // Step Box Colors
        const colorStep1Bg = 'F8F9FA'; const colorStep1Border = '5C6BC0';
        const colorStep2Bg = 'FDFBF7'; const colorStep2Border = '8D6E63';
        const colorStep3Bg = 'F1F8E9'; const colorStep3Border = '66BB6A';

        const fontTitle = 'Montserrat';
        const fontBody = 'Noto Sans JP';

        // Master Slide
        pres.defineSlideMaster({
            title: 'MASTER_SLIDE',
            background: { color: 'FFFFFF' },
            objects: [
                { rect: { x: 0, y: 0, w: '100%', h: 0.1, fill: { type: 'linear', color1: colorPrimary, color2: colorAccent, angle: 90 } } },
            ],
            slideNumber: { x: 12.8, y: 7.0, color: colorLightText, fontSize: 12, fontFace: fontTitle }
        });

        pres.defineSlideMaster({
            title: 'TITLE_SLIDE_MASTER',
            background: { color: 'FFFFFF' },
            slideNumber: { x: 12.8, y: 7.0, color: colorLightText, fontSize: 12, fontFace: fontTitle }
        });

        slidesData.forEach((slideData) => {
            let slide = pres.addSlide({ masterName: slideData.type === 'title' ? 'TITLE_SLIDE_MASTER' : 'MASTER_SLIDE' });

            if (slideData.type === 'title') {
                slide.addText(slideData.title, { 
                    x: 0.8, y: 2.0, w: '85%', h: 2.5, 
                    fontSize: 44, color: colorPrimary, bold: true, fontFace: fontTitle, align: 'left', lineSpacing:48
                });
                slide.addShape(pres.ShapeType.rect, { x: 0.8, y: 4.8, w: 0.1, h: 1.5, fill: colorAccent });
                slide.addText(slideData.sub, { 
                    x: 1.0, y: 4.8, w: '80%', h: 1.5, 
                    fontSize: 20, color: colorText, align: 'left', fontFace: fontBody, lineSpacing: 32
                });

            } else if (slideData.type === 'concept') {
                slide.addText(slideData.title, { 
                    x: 0.8, y: 0.8, w: '90%', h: 0.8, 
                    fontSize: 32, color: colorPrimary, bold: true, fontFace: fontTitle, valign:'bottom'
                });
                slide.addShape(pres.ShapeType.rect, { x: 0.8, y: 1.65, w: 1.2, h: 0.05, fill: colorAccent });

                let contentText = slideData.content.map(t => t.replace(/\*\*/g, '')).join('\n\n');
                slide.addText(contentText, {
                    x: 0.8, y: 2.2, w: '85%', h: 4.5,
                    fontSize: 20, color: colorText, lineSpacing: 36, bullet: { color: colorAccent }, fontFace: fontBody
                });

            } else if (slideData.type === 'case') {
                // Title
                slide.addText(slideData.title, { 
                    x: 0.8, y: 0.6, w: '90%', h: 0.8, 
                    fontSize: 32, color: colorPrimary, bold: true, fontFace: fontTitle, valign:'bottom'
                });
                slide.addShape(pres.ShapeType.rect, { x: 0.8, y: 1.45, w: 1.2, h: 0.05, fill: colorAccent });
                // Subtitle
                slide.addText(slideData.subTitle, {
                    x: 0.8, y: 1.6, w: '90%', h: 0.5,
                    fontSize: 18, color: colorLightText, fontFace: fontBody
                });

                const yPos = 2.5;
                const boxW = 3.8;
                const boxH = 4.0;
                const arrowW = 0.6;
                
                // Step 1
                slide.addShape(pres.ShapeType.rect, { x: 0.8, y: yPos, w: boxW, h: 0.1, fill: colorStep1Border });
                slide.addShape(pres.ShapeType.rect, { x: 0.8, y: yPos + 0.1, w: boxW, h: boxH, fill: colorStep1Bg });
                slide.addText("STEP-1", { x: 1.0, y: yPos + 0.3, w: boxW-0.4, fontSize: 10, color: colorLightText, fontFace: fontTitle });
                slide.addText(slideData.step1.label, { x: 1.0, y: yPos + 0.6, w: boxW-0.4, fontSize: 14, bold: true, color: colorPrimary, fontFace: fontTitle });
                slide.addText(slideData.step1.text, { x: 1.0, y: yPos + 1.1, w: boxW-0.4, h: boxH-1.2, fontSize: 12, color: colorText, valign: 'top', fontFace: fontBody });

                // Arrow
                slide.addText("‚ñ∂", { x: 4.7, y: yPos + 1.8, w: arrowW, fontSize: 24, color: colorAccent, align:'center' });

                // Step 2
                slide.addShape(pres.ShapeType.rect, { x: 5.4, y: yPos, w: boxW, h: 0.1, fill: colorStep2Border });
                slide.addShape(pres.ShapeType.rect, { x: 5.4, y: yPos + 0.1, w: boxW, h: boxH, fill: colorStep2Bg });
                slide.addText("STEP-2", { x: 5.6, y: yPos + 0.3, w: boxW-0.4, fontSize: 10, color: colorLightText, fontFace: fontTitle });
                slide.addText(slideData.step2.label, { x: 5.6, y: yPos + 0.6, w: boxW-0.4, fontSize: 14, bold: true, color: colorPrimary, fontFace: fontTitle });
                slide.addText(slideData.step2.text, { x: 5.6, y: yPos + 1.1, w: boxW-0.4, h: boxH-1.2, fontSize: 12, color: colorText, valign: 'top', fontFace: fontBody });

                // Arrow
                slide.addText("‚ñ∂", { x: 9.3, y: yPos + 1.8, w: arrowW, fontSize: 24, color: colorAccent, align:'center' });

                // Step 3
                slide.addShape(pres.ShapeType.rect, { x: 10.0, y: yPos, w: boxW, h: 0.1, fill: colorStep3Border });
                slide.addShape(pres.ShapeType.rect, { x: 10.0, y: yPos + 0.1, w: boxW, h: boxH, fill: colorStep3Bg });
                slide.addText("STEP-3", { x: 10.2, y: yPos + 0.3, w: boxW-0.4, fontSize: 10, color: colorLightText, fontFace: fontTitle });
                slide.addText(slideData.step3.label, { x: 10.2, y: yPos + 0.6, w: boxW-0.4, fontSize: 14, bold: true, color: colorPrimary, fontFace: fontTitle });
                slide.addText(slideData.step3.text, { x: 10.2, y: yPos + 1.1, w: boxW-0.4, h: boxH-1.2, fontSize: 12, color: colorText, valign: 'top', fontFace: fontBody });
            }
        });

        pres.writeFile({ fileName: 'Cosmetics_AI_Case_Study.pptx' });
    }

    renderPreview();
</script>
</body>
</html>
